###############################################################################
#
# IAR C/C++ Compiler V9.30.3.3983 for 8051                04/May/2017  14:07:10
# Copyright 2004-2016 IAR Systems AB.
# Evaluation license - IAR Embedded Workbench for 8051, Evaluation version 9.30
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Components\hal\target\CC2530EB\hal_uart.c
#    Command line       =  
#        -f "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wCoord.cfg"
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
#        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
#        -DZDO_COORDINATOR -DRTR_NWK) -f "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0x0422
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07,
#        0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C,
#        0x0D}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
#        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
#        -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)
#        -DREJOIN_POLL_RATE=440 "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Components\hal\target\CC2530EB\hal_uart.c" -D
#        ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC -D
#        LCD_SUPPORTED=DEBUG -lC "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\CoordinatorEB\List"
#        -lA "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\CoordinatorEB\List"
#        --diag_suppress Pe001,Pa010 -o "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\CoordinatorEB\Obj"
#        -e --no_code_motion --debug --core=plain --dptr=16,1
#        --data_model=large --code_model=banked
#        --calling_convention=xdata_reentrant --place_constants=data_rom
#        --nr_virtual_regs 16 -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\Source\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\ZMain\TI2530DB\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\hal\include\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\include\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mt\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\osal\include\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\services\saddr\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\services\sdata\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\af\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sec\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sys\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\zmac\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
#        -I "C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\dll\"
#        -Ohz --require_prototypes
#    List file          =  
#        C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\CoordinatorEB\List\hal_uart.lst
#    Object file        =  
#        C:\Users\ljuic\Desktop\New
#        folder\ZigBeeCoordinator\Projects\zstack\Samples\GenericApp\CC2530DB\CoordinatorEB\Obj\hal_uart.r51
#
###############################################################################

C:\Users\ljuic\Desktop\New folder\ZigBeeCoordinator\Components\hal\target\CC2530EB\hal_uart.c
      1          /**************************************************************************************************
      2            Filename:       _hal_uart.c
      3            Revised:        $Date: 2009-06-12 09:16:43 -0700 (Fri, 12 Jun 2009) $
      4            Revision:       $Revision: 20142 $
      5          
      6            Description: This file contains the interface to the H/W UART driver.
      7          
      8          
      9            Copyright 2006-2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41           * INCLUDES
     42           */
     43          ////////////////////////////////////////////////////////////////////////////////////// 
     44          //#include "hal_drivers.h"
     45          #include "GenericApp.h"
     46          #include "OSAL.h"
     47          ////////////////////////////////////////////////////////////////////////////////////// 
     48          
     49          #include "hal_board_cfg.h"

   \                                 In  segment SFR_AN, at 0x95
   \   unsigned char volatile __sfr ST0
   \                     ST0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9a
   \   unsigned char volatile __sfr IEN2
   \                     IEN2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc6
   \   unsigned char volatile __sfr CLKCONCMD
   \                     CLKCONCMD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe8
   \   union <unnamed> volatile __sfr _A_IRCON2
   \                     _A_IRCON2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf1
   \   unsigned char volatile __sfr PERCFG
   \                     PERCFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf2
   \   unsigned char volatile __sfr ADCCFG
   \                     ADCCFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf7
   \   unsigned char volatile __sfr P2INP
   \                     P2INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf8
   \   union <unnamed> volatile __sfr _A_U1CSR
   \                     _A_U1CSR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf9
   \   unsigned char volatile __sfr U1DBUF
   \                     U1DBUF:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfa
   \   unsigned char volatile __sfr U1BAUD
   \                     U1BAUD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfb
   \   unsigned char volatile __sfr U1UCR
   \                     U1UCR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfc
   \   unsigned char volatile __sfr U1GCR
   \                     U1GCR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xff
   \   unsigned char volatile __sfr P2DIR
   \                     P2DIR:
   \   000000                DS 1
     50          #include "hal_defs.h"
     51          #include "hal_types.h"
     52          #include "hal_uart.h"
     53          
     54          /*********************************************************************
     55           * MACROS
     56           */
     57          
     58          /*********************************************************************
     59           * TYPEDEFS
     60           */
     61          
     62          /*********************************************************************
     63           * CONSTANTS
     64           */
     65          
     66          /*********************************************************************
     67           * GLOBAL VARIABLES
     68           */
     69          extern halUARTCfg_t uartConfig;
     70          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     71          uint8 TX_BUFFER[128];
   \                     TX_BUFFER:
   \   000000                DS 128
   \   000080                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     72          uint8 RX_BUFFER[128];
   \                     RX_BUFFER:
   \   000000                DS 128
   \   000080                REQUIRE __INIT_XDATA_Z
     73          
     74          
     75          /*********************************************************************
     76           * GLOBAL FUNCTIONS
     77           */
     78          
     79          /*********************************************************************
     80           * LOCAL VARIABLES
     81           */
     82          
     83          /*********************************************************************
     84           * LOCAL FUNCTIONS
     85           */
     86          
     87          #if HAL_UART_DMA
     88          #include "_hal_uart_dma.c"
     89          #endif
     90          #if HAL_UART_ISR
     91          #include "_hal_uart_isr.c"

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \   static uartISRCfg_t isrCfg
   \                     isrCfg:
   \   000000                DS 265
   \   000109                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \   __banked_func __xdata_reentrant uint16 HalUARTReadISR(uint8 *, uint16)
   \                     HalUARTReadISR:
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   7800         MOV     R0,#0x0
   \   000007   7900         MOV     R1,#0x0
   \   000009   8027         SJMP    ??HalUARTReadISR_0
   \                     ??HalUARTReadISR_1:
   \   00000B   74..         MOV     A,#isrCfg & 0xff
   \   00000D   2E           ADD     A,R6
   \   00000E   F582         MOV     DPL,A
   \   000010   E4           CLR     A
   \   000011   34..         ADDC    A,#(isrCfg >> 8) & 0xff
   \   000013   F583         MOV     DPH,A
   \   000015   E0           MOVX    A,@DPTR
   \   000016   8A82         MOV     DPL,R2
   \   000018   8B83         MOV     DPH,R3
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   90....       MOV     DPTR,#isrCfg + 128
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   04           INC     A
   \   000020   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   000023   C3           CLR     C
   \   000024   9480         SUBB    A,#-0x80
   \   000026   4005         JC      ??HalUARTReadISR_2
   \   000028   90....       MOV     DPTR,#isrCfg + 128
   \   00002B   E4           CLR     A
   \   00002C   F0           MOVX    @DPTR,A
   \                     ??HalUARTReadISR_2:
   \   00002D   08           INC     R0
   \   00002E   E8           MOV     A,R0
   \   00002F   7001         JNZ     ??HalUARTReadISR_0
   \   000031   09           INC     R1
   \                     ??HalUARTReadISR_0:
   \   000032   90....       MOV     DPTR,#isrCfg + 128
   \   000035   E0           MOVX    A,@DPTR
   \   000036   FE           MOV     R6,A
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   6E           XRL     A,R6
   \   00003A   6007         JZ      ??HalUARTReadISR_3
   \   00003C   C3           CLR     C
   \   00003D   E8           MOV     A,R0
   \   00003E   9C           SUBB    A,R4
   \   00003F   E9           MOV     A,R1
   \   000040   9D           SUBB    A,R5
   \   000041   40C8         JC      ??HalUARTReadISR_1
   \                     ??HalUARTReadISR_3:
   \   000043   90....       MOV     DPTR,#isrCfg + 128
   \   000046   E4           CLR     A
   \   000047   F0           MOVX    @DPTR,A
   \   000048   A3           INC     DPTR
   \   000049   F0           MOVX    @DPTR,A
   \   00004A   E8           MOV     A,R0
   \   00004B   FA           MOV     R2,A
   \   00004C   E9           MOV     A,R1
   \   00004D   FB           MOV     R3,A
   \   00004E   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   A3           INC     DPTR
   \   000006   AA82         MOV     R2,DPL
   \   000008   AB83         MOV     R3,DPH
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \   __banked_func __xdata_reentrant uint16 HalUARTWriteISR(uint8 *, uint16)
   \                     HalUARTWriteISR:
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   90....       MOV     DPTR,#isrCfg + 260
   \   000008   E0           MOVX    A,@DPTR
   \   000009   F8           MOV     R0,A
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   C3           CLR     C
   \   00000D   98           SUBB    A,R0
   \   00000E   90....       MOV     DPTR,#isrCfg + 260
   \   000011   E0           MOVX    A,@DPTR
   \   000012   FE           MOV     R6,A
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F8           MOV     R0,A
   \   000016   EE           MOV     A,R6
   \   000017   5010         JNC     ??HalUARTWriteISR_0
   \   000019   C3           CLR     C
   \   00001A   98           SUBB    A,R0
   \   00001B   F8           MOV     R0,A
   \   00001C   95E0         SUBB    A,0xE0 /* A   */
   \   00001E   F9           MOV     R1,A
   \   00001F   E8           MOV     A,R0
   \   000020   24FF         ADD     A,#-0x1
   \   000022   18           DEC     R0
   \   000023   E9           MOV     A,R1
   \   000024   34FF         ADDC    A,#-0x1
   \   000026   F9           MOV     R1,A
   \   000027   800D         SJMP    ??HalUARTWriteISR_1
   \                     ??HalUARTWriteISR_0:
   \   000029   C3           CLR     C
   \   00002A   98           SUBB    A,R0
   \   00002B   F8           MOV     R0,A
   \   00002C   95E0         SUBB    A,0xE0 /* A   */
   \   00002E   F9           MOV     R1,A
   \   00002F   E8           MOV     A,R0
   \   000030   247F         ADD     A,#0x7f
   \   000032   F8           MOV     R0,A
   \   000033   5001         JNC     ??HalUARTWriteISR_1
   \   000035   09           INC     R1
   \                     ??HalUARTWriteISR_1:
   \   000036   C3           CLR     C
   \   000037   E8           MOV     A,R0
   \   000038   9C           SUBB    A,R4
   \   000039   E9           MOV     A,R1
   \   00003A   9D           SUBB    A,R5
   \   00003B   5006         JNC     ??HalUARTWriteISR_2
   \   00003D   7A00         MOV     R2,#0x0
   \   00003F   7B00         MOV     R3,#0x0
   \   000041   8048         SJMP    ??HalUARTWriteISR_3
   \                     ??HalUARTWriteISR_2:
   \   000043   7800         MOV     R0,#0x0
   \   000045   7900         MOV     R1,#0x0
   \   000047   800B         SJMP    ??HalUARTWriteISR_4
   \                     ??HalUARTWriteISR_5:
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   04           INC     A
   \                     ??HalUARTWriteISR_6:
   \   00004B   F0           MOVX    @DPTR,A
   \   00004C   439A08       ORL     0x9a,#0x8
   \   00004F   08           INC     R0
   \   000050   E8           MOV     A,R0
   \   000051   7001         JNZ     ??HalUARTWriteISR_4
   \   000053   09           INC     R1
   \                     ??HalUARTWriteISR_4:
   \   000054   C3           CLR     C
   \   000055   E8           MOV     A,R0
   \   000056   9C           SUBB    A,R4
   \   000057   E9           MOV     A,R1
   \   000058   9D           SUBB    A,R5
   \   000059   502C         JNC     ??HalUARTWriteISR_7
   \   00005B   8A82         MOV     DPL,R2
   \   00005D   8B83         MOV     DPH,R3
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   C0E0         PUSH    A
   \   000062   90....       MOV     DPTR,#isrCfg + 261
   \   000065   E0           MOVX    A,@DPTR
   \   000066   FE           MOV     R6,A
   \   000067   74..         MOV     A,#(isrCfg + 132) & 0xff
   \   000069   2E           ADD     A,R6
   \   00006A   F582         MOV     DPL,A
   \   00006C   E4           CLR     A
   \   00006D   34..         ADDC    A,#((isrCfg + 132) >> 8) & 0xff
   \   00006F   F583         MOV     DPH,A
   \   000071   D0E0         POP     A
   \   000073   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   000076   90....       MOV     DPTR,#isrCfg + 262
   \   000079   E4           CLR     A
   \   00007A   F0           MOVX    @DPTR,A
   \   00007B   90....       MOV     DPTR,#isrCfg + 261
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   C3           CLR     C
   \   000080   947F         SUBB    A,#0x7f
   \   000082   40C5         JC      ??HalUARTWriteISR_5
   \   000084   E4           CLR     A
   \   000085   80C4         SJMP    ??HalUARTWriteISR_6
   \                     ??HalUARTWriteISR_7:
   \   000087   E8           MOV     A,R0
   \   000088   FA           MOV     R2,A
   \   000089   E9           MOV     A,R1
   \   00008A   FB           MOV     R3,A
   \                     ??HalUARTWriteISR_3:
   \   00008B   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   00008E                REQUIRE IEN2

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
   \   __near_func __xdata_reentrant __interrupt void halUart1RxIsr(void)
   \                     halUart1RxIsr:
   \   000000   C0E0         PUSH    A
   \   000002   74F2         MOV     A,#-0xe
   \   000004   12....       LCALL   ?INTERRUPT_ENTER_XSP
   \   000007                ; Saved register size: 14
   \   000007                ; Auto size: 0
   \   000007   A8F9         MOV     R0,0xf9+0x0
   \   000009   E8           MOV     A,R0
   \   00000A   C0E0         PUSH    A
   \   00000C   90....       MOV     DPTR,#isrCfg + 129
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F8           MOV     R0,A
   \   000011   74..         MOV     A,#isrCfg & 0xff
   \   000013   28           ADD     A,R0
   \   000014   F582         MOV     DPL,A
   \   000016   E4           CLR     A
   \   000017   34..         ADDC    A,#(isrCfg >> 8) & 0xff
   \   000019   F583         MOV     DPH,A
   \   00001B   D0E0         POP     A
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   90....       MOV     DPTR,#isrCfg + 128
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F8           MOV     R0,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   68           XRL     A,R0
   \   000026   7006         JNZ     ??halUart1RxIsr_0
   \   000028   E595         MOV     A,0x95
   \   00002A   90....       MOV     DPTR,#isrCfg + 131
   \   00002D   F0           MOVX    @DPTR,A
   \                     ??halUart1RxIsr_0:
   \   00002E   90....       MOV     DPTR,#isrCfg + 129
   \   000031   E0           MOVX    A,@DPTR
   \   000032   04           INC     A
   \   000033   F0           MOVX    @DPTR,A
   \   000034   C3           CLR     C
   \   000035   9480         SUBB    A,#-0x80
   \   000037   4002         JC      ??halUart1RxIsr_1
   \   000039   E4           CLR     A
   \   00003A   F0           MOVX    @DPTR,A
   \                     ??halUart1RxIsr_1:
   \   00003B   A3           INC     DPTR
   \   00003C   74C6         MOV     A,#-0x3a
   \   00003E   F0           MOVX    @DPTR,A
   \   00003F   90....       MOV     DPTR,#isrCfg + 129
   \   000042   E0           MOVX    A,@DPTR
   \   000043   C3           CLR     C
   \   000044   941D         SUBB    A,#0x1d
   \   000046   4003         JC      ??halUart1RxIsr_2
   \   000048                ; Setup parameters for call to function halProcessUartInterrupt
   \   000048   12....       LCALL   `??halProcessUartInterrupt::?relay`; Banked call to: halProcessUartInterrupt
   \                     ??halUart1RxIsr_2:
   \   00004B   7F01         MOV     R7,#0x1
   \   00004D   02....       LJMP    ?INTERRUPT_LEAVE_XSP
   \   000050                REQUIRE U1DBUF
   \   000050                REQUIRE ST0

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
   \   __near_func __xdata_reentrant __interrupt void halUart1TxIsr(void)
   \                     halUart1TxIsr:
   \   000000   C0E0         PUSH    A
   \   000002   C0D0         PUSH    PSW
   \   000004   E8           MOV     A,R0
   \   000005   C0E0         PUSH    A
   \   000007   E9           MOV     A,R1
   \   000008   C0E0         PUSH    A
   \   00000A   C082         PUSH    DPL
   \   00000C   C083         PUSH    DPH
   \   00000E                ; Saved register size: 6
   \   00000E                ; Auto size: 0
   \   00000E   90....       MOV     DPTR,#isrCfg + 260
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F8           MOV     R0,A
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   68           XRL     A,R0
   \   000016   7008         JNZ     ??halUart1TxIsr_0
   \   000018   539AF7       ANL     0x9a,#0xf7
   \   00001B   A3           INC     DPTR
   \   00001C   7401         MOV     A,#0x1
   \   00001E   8022         SJMP    ??halUart1TxIsr_1
   \                     ??halUart1TxIsr_0:
   \   000020   C2EA         CLR     0xe8.2
   \   000022   90....       MOV     DPTR,#isrCfg + 260
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F8           MOV     R0,A
   \   000027   7401         MOV     A,#0x1
   \   000029   28           ADD     A,R0
   \   00002A   F0           MOVX    @DPTR,A
   \   00002B   74..         MOV     A,#(isrCfg + 132) & 0xff
   \   00002D   28           ADD     A,R0
   \   00002E   F582         MOV     DPL,A
   \   000030   E4           CLR     A
   \   000031   34..         ADDC    A,#((isrCfg + 132) >> 8) & 0xff
   \   000033   F583         MOV     DPH,A
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5F9         MOV     0xf9,A
   \   000038   90....       MOV     DPTR,#isrCfg + 260
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   C3           CLR     C
   \   00003D   9480         SUBB    A,#-0x80
   \   00003F   4002         JC      ??halUart1TxIsr_2
   \   000041   E4           CLR     A
   \                     ??halUart1TxIsr_1:
   \   000042   F0           MOVX    @DPTR,A
   \                     ??halUart1TxIsr_2:
   \   000043   D083         POP     DPH
   \   000045   D082         POP     DPL
   \   000047   D0E0         POP     A
   \   000049   F9           MOV     R1,A
   \   00004A   D0E0         POP     A
   \   00004C   F8           MOV     R0,A
   \   00004D   D0D0         POP     PSW
   \   00004F   D0E0         POP     A
   \   000051   32           RETI
   \   000052                REQUIRE IEN2
   \   000052                REQUIRE _A_IRCON2
   \   000052                REQUIRE U1DBUF
     92          #endif
     93          #if HAL_UART_USB
     94          #include "_hal_uart_usb.c"
     95          #endif
     96          
     97          /******************************************************************************
     98           * @fn      HalUARTInit
     99           *
    100           * @brief   Initialize the UART
    101           *
    102           * @param   none
    103           *
    104           * @return  none
    105           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    106          void HalUARTInit(void)
   \                     HalUARTInit:
    107          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    108            /*
    109          #if HAL_UART_DMA
    110            HalUARTInitDMA();
    111          #endif
    112            */
    113          //#if HAL_UART_ISR
    114           // HalUARTInitISR();
    115            
    116            
    117              CLKCONCMD =0x00;                                                            //Podesavanje clocka na 32MHz
   \   000004   75C600       MOV     0xc6,#0x0
    118              P2INP = 0x60;
   \   000007   75F760       MOV     0xf7,#0x60
    119            /*
    120              PERCFG = 0x02;
    121              //PERCFG = 0x00;                                                              //Podesavanje primarnih funkcija modula 
    122              P0SEL = 0x0C;                                                               //Podesavanje osnovne ili periferne funkcije odredjenog pina(0-osnovna ; 1-periferna)
    123              
    124            
    125              U0CSR = 0xC0;                                                               //Prvi bit 1 je UART mode
    126              U0GCR = 0x08;                                                               //Poslednjih 5 bita odredjuje baud rate exponent vrijednost
    127           
    128              
    129              U0BAUD = 0x3A;  
    130            */
    131           // halUARTCfg_t uartConfig;
    132          	
    133            // initialize structure for uart config
    134            
    135            //P2INP = 0x40;
    136            //CLKCONCMD =0x00; 
    137          
    138            uartConfig.configured = TRUE;
   \   00000A   90....       MOV     DPTR,#uartConfig
   \   00000D   7401         MOV     A,#0x1
   \   00000F   F0           MOVX    @DPTR,A
    139            uartConfig.baudRate = HAL_UART_BR_9600;
   \   000010   A3           INC     DPTR
   \   000011   E4           CLR     A
   \   000012   F0           MOVX    @DPTR,A
    140            uartConfig.flowControl = FALSE;
   \   000013   A3           INC     DPTR
   \   000014   F0           MOVX    @DPTR,A
    141            
    142            uartConfig.idleTimeout = HAL_UART_ISR_IDLE;
   \   000015   90....       MOV     DPTR,#uartConfig + 5
   \   000018   74C6         MOV     A,#-0x3a
   \   00001A   F0           MOVX    @DPTR,A
    143            uartConfig.intEnable = TRUE;
   \   00001B   90....       MOV     DPTR,#uartConfig + 22
   \   00001E   7401         MOV     A,#0x1
   \   000020   F0           MOVX    @DPTR,A
    144            uartConfig.callBackFunc = NULL;
   \   000021   90....       MOV     DPTR,#uartConfig + 27
   \   000024   E4           CLR     A
   \   000025   F0           MOVX    @DPTR,A
   \   000026   A3           INC     DPTR
   \   000027   F0           MOVX    @DPTR,A
    145          	
    146            //config tx options
    147            uartConfig.tx.maxBufSize = HAL_UART_ISR_TX_MAX;
   \   000028   90....       MOV     DPTR,#uartConfig + 18
   \   00002B   7480         MOV     A,#-0x80
   \   00002D   F0           MOVX    @DPTR,A
   \   00002E   A3           INC     DPTR
   \   00002F   E4           CLR     A
   \   000030   F0           MOVX    @DPTR,A
    148            uartConfig.tx.pBuffer = TX_BUFFER;
   \   000031   A3           INC     DPTR
   \   000032   74..         MOV     A,#TX_BUFFER & 0xff
   \   000034   F0           MOVX    @DPTR,A
   \   000035   A3           INC     DPTR
   \   000036   74..         MOV     A,#(TX_BUFFER >> 8) & 0xff
   \   000038   F0           MOVX    @DPTR,A
    149            
    150            //config rx options
    151            uartConfig.rx.maxBufSize = HAL_UART_ISR_RX_MAX;
   \   000039   90....       MOV     DPTR,#uartConfig + 10
   \   00003C   7480         MOV     A,#-0x80
   \   00003E   F0           MOVX    @DPTR,A
   \   00003F   A3           INC     DPTR
   \   000040   E4           CLR     A
   \   000041   F0           MOVX    @DPTR,A
    152            uartConfig.rx.pBuffer = RX_BUFFER;
   \   000042   A3           INC     DPTR
   \   000043   74..         MOV     A,#RX_BUFFER & 0xff
   \   000045   F0           MOVX    @DPTR,A
   \   000046   A3           INC     DPTR
   \   000047   74..         MOV     A,#(RX_BUFFER >> 8) & 0xff
   \   000049   F0           MOVX    @DPTR,A
    153            
    154              HalUARTInitISR();
   \   00004A   53FF3F       ANL     0xff,#0x3f
   \   00004D   85FFFF       MOV     0xff,0xff
   \   000050   43F102       ORL     0xf1,#0x2
   \   000053   43F4C0       ORL     0xf4,#0xc0
   \   000056   53F23F       ANL     0xf2,#0x3f
   \   000059   75F880       MOV     0xf8,#-0x80
   \   00005C   75FB80       MOV     0xfb,#-0x80
    155          
    156            
    157          //#endif
    158            /*
    159          #if HAL_UART_USB
    160            HalUARTInitUSB();
    161          #endif
    162            */
    163          }
   \   00005F   02....       LJMP    ?Subroutine1 & 0xFFFF
   \   000062                REQUIRE CLKCONCMD
   \   000062                REQUIRE P2INP
   \   000062                REQUIRE P2DIR
   \   000062                REQUIRE PERCFG
   \   000062                REQUIRE P1SEL
   \   000062                REQUIRE ADCCFG
   \   000062                REQUIRE _A_U1CSR
   \   000062                REQUIRE U1UCR

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    164          
    165          /******************************************************************************
    166           * @fn      HalUARTOpen
    167           *
    168           * @brief   Open a port according tp the configuration specified by parameter.
    169           *
    170           * @param   port   - UART port
    171           *          config - contains configuration information
    172           *
    173           * @return  Status of the function call
    174           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    175          uint8 HalUARTOpen(uint8 port, halUARTCfg_t *config)
   \                     HalUARTOpen:
    176          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
    177            (void)port;
    178            (void)config;
    179          /*
    180          #if (HAL_UART_DMA == 1)
    181            if (port == HAL_UART_PORT_0)  HalUARTOpenDMA(config);
    182          #endif
    183          #if (HAL_UART_DMA == 2)
    184            if (port == HAL_UART_PORT_1)  HalUARTOpenDMA(config);
    185          #endif
    186            
    187          #if (HAL_UART_ISR == 1)
    188            if (port == HAL_UART_PORT_0)  HalUARTOpenISR(config);
    189          #endif
    190            
    191            */
    192          #if (HAL_UART_ISR == 2)
    193            if (port == HAL_UART_PORT_1)  HalUARTOpenISR(config);
   \   000006   7401         MOV     A,#0x1
   \   000008   6C           XRL     A,R4
   \   000009   706F         JNZ     ??HalUARTOpen_0
   \   00000B   EA           MOV     A,R2
   \   00000C   241B         ADD     A,#0x1b
   \   00000E   F582         MOV     DPL,A
   \   000010   E4           CLR     A
   \   000011   3B           ADDC    A,R3
   \   000012   F583         MOV     DPH,A
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F8           MOV     R0,A
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F9           MOV     R1,A
   \   000019   90....       MOV     DPTR,#isrCfg + 263
   \   00001C   E8           MOV     A,R0
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   A3           INC     DPTR
   \   00001F   E9           MOV     A,R1
   \   000020   F0           MOVX    @DPTR,A
   \   000021   8A82         MOV     DPL,R2
   \   000023   8B83         MOV     DPH,R3
   \   000025   A3           INC     DPTR
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6403         XRL     A,#0x3
   \   000029   600F         JZ      ??HalUARTOpen_1
   \   00002B   8A82         MOV     DPL,R2
   \   00002D   8B83         MOV     DPH,R3
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   6404         XRL     A,#0x4
   \   000033   6005         JZ      ??HalUARTOpen_1
   \   000035   75FA3B       MOV     0xfa,#0x3b
   \   000038   8003         SJMP    ??HalUARTOpen_2
   \                     ??HalUARTOpen_1:
   \   00003A   75FAD8       MOV     0xfa,#-0x28
   \                     ??HalUARTOpen_2:
   \   00003D   8A82         MOV     DPL,R2
   \   00003F   8B83         MOV     DPH,R3
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   6013         JZ      ??HalUARTOpen_3
   \   000045   14           DEC     A
   \   000046   600B         JZ      ??HalUARTOpen_4
   \   000048   14           DEC     A
   \   000049   6003         JZ      ??HalUARTOpen_5
   \   00004B   14           DEC     A
   \   00004C   700F         JNZ     ??HalUARTOpen_6
   \                     ??HalUARTOpen_5:
   \   00004E   75FC0A       MOV     0xfc,#0xa
   \   000051   800D         SJMP    ??HalUARTOpen_7
   \                     ??HalUARTOpen_4:
   \   000053   75FC09       MOV     0xfc,#0x9
   \   000056   8008         SJMP    ??HalUARTOpen_7
   \                     ??HalUARTOpen_3:
   \   000058   75FC08       MOV     0xfc,#0x8
   \   00005B   8003         SJMP    ??HalUARTOpen_7
   \                     ??HalUARTOpen_6:
   \   00005D   75FC0B       MOV     0xfc,#0xb
   \                     ??HalUARTOpen_7:
   \   000060   8A82         MOV     DPL,R2
   \   000062   8B83         MOV     DPH,R3
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   E0           MOVX    A,@DPTR
   \   000067   6008         JZ      ??HalUARTOpen_8
   \   000069   75FB42       MOV     0xfb,#0x42
   \   00006C   43F430       ORL     0xf4,#0x30
   \   00006F   8003         SJMP    ??HalUARTOpen_9
   \                     ??HalUARTOpen_8:
   \   000071   75FB02       MOV     0xfb,#0x2
   \                     ??HalUARTOpen_9:
   \   000074   D2FE         SETB    0xf8.6
   \   000076   D2AB         SETB    0xa8.3
   \   000078   D2EA         SETB    0xe8.2
    194          #endif
    195            /*
    196          #if (HAL_UART_USB)
    197            HalUARTOpenUSB(config);
    198          #endif
    199            */
    200            return HAL_UART_SUCCESS;
   \                     ??HalUARTOpen_0:
   \   00007A   7900         MOV     R1,#0x0
   \   00007C   80..         SJMP    ?Subroutine1
   \   00007E                REQUIRE U1BAUD
   \   00007E                REQUIRE U1GCR
   \   00007E                REQUIRE U1UCR
   \   00007E                REQUIRE P1SEL
   \   00007E                REQUIRE _A_U1CSR
   \   00007E                REQUIRE _A_IEN0
   \   00007E                REQUIRE _A_IRCON2
    201          }
    202          
    203          /*****************************************************************************
    204           * @fn      HalUARTRead
    205           *
    206           * @brief   Read a buffer from the UART
    207           *
    208           * @param   port - USART module designation
    209           *          buf  - valid data buffer at least 'len' bytes in size
    210           *          len  - max length number of bytes to copy to 'buf'
    211           *
    212           * @return  length of buffer that was read
    213           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    214          uint16 HalUARTRead(uint8 port, uint8 *buf, uint16 len)
   \                     HalUARTRead:
    215          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    216            (void)port;
    217            (void)buf;
    218            (void)len;
    219          
    220          #if (HAL_UART_DMA == 1)
    221            if (port == HAL_UART_PORT_0)  return HalUARTReadDMA(buf, len);
    222          #endif
    223          #if (HAL_UART_DMA == 2)
    224            if (port == HAL_UART_PORT_1)  return HalUARTReadDMA(buf, len);
    225          #endif
    226            
    227          #if (HAL_UART_ISR == 1)
    228            if (port == HAL_UART_PORT_0)  return HalUARTReadISR(buf, len);
    229          #endif
    230            
    231            
    232          #if (HAL_UART_ISR == 2)
    233            if (port == HAL_UART_PORT_1)  return HalUARTReadISR(buf, len);
   \   000007   7401         MOV     A,#0x1
   \   000009   6E           XRL     A,R6
   \   00000A   7005         JNZ     ??HalUARTRead_0
   \   00000C                ; Setup parameters for call to function HalUARTReadISR
   \   00000C   12....       LCALL   `??HalUARTReadISR::?relay`; Banked call to: HalUARTReadISR
   \   00000F   8004         SJMP    ??HalUARTRead_1
    234          #endif
    235          
    236          #if HAL_UART_USB
    237            return HalUARTRx(buf, len);
    238          #else
    239            
    240          #endif
    241          
    242            return 0;
   \                     ??HalUARTRead_0:
   \   000011   7A00         MOV     R2,#0x0
   \   000013   7B00         MOV     R3,#0x0
   \                     ??HalUARTRead_1:
   \   000015                REQUIRE ?Subroutine0
   \   000015                ; // Fall through to label ?Subroutine0
    243          }
    244          
    245          /******************************************************************************
    246           * @fn      HalUARTWrite
    247           *
    248           * @brief   Write a buffer to the UART.
    249           *
    250           * @param   port - UART port
    251           *          buf  - pointer to the buffer that will be written, not freed
    252           *          len  - length of
    253           *
    254           * @return  length of the buffer that was sent
    255           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    256          uint16 HalUARTWrite(uint8 port, uint8 *buf, uint16 len)
   \                     HalUARTWrite:
    257          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    258            (void)port;
    259            (void)buf;
    260            (void)len;
    261          /*  uint8 i;
    262            
    263            for(i=0;i<len;i++)
    264            {
    265             U0DBUF = *(buf + i);
    266              
    267              while((U0CSR & 0x01) == 0x01)
    268              {
    269              }
    270            }
    271           */
    272                /*
    273          #if (HAL_UART_DMA == 1)
    274            if (port == HAL_UART_PORT_0)  return HalUARTWriteDMA(buf, len);
    275          #endif
    276          #if (HAL_UART_DMA == 2)
    277            if (port == HAL_UART_PORT_1)  return HalUARTWriteDMA(buf, len);
    278          #endif
    279          
    280          #if (HAL_UART_ISR == 1)
    281            if (port == HAL_UART_PORT_0)  return HalUARTWriteISR(buf, len);
    282          #endif
    283          
    284          */
    285          #if (HAL_UART_ISR == 2)
    286            
    287            if (port == HAL_UART_PORT_1) 
   \   000007   7401         MOV     A,#0x1
   \   000009   6E           XRL     A,R6
   \   00000A   7005         JNZ     ??HalUARTWrite_0
    288            {
    289             // HalLcdWriteString("Sico----------------------",0);
    290              return HalUARTWriteISR(buf, len);
   \   00000C                ; Setup parameters for call to function HalUARTWriteISR
   \   00000C   12....       LCALL   `??HalUARTWriteISR::?relay`; Banked call to: HalUARTWriteISR
   \   00000F   8004         SJMP    ??HalUARTWrite_1
    291            }
    292            //return HalUARTWriteISR(buf, len);
    293          #endif
    294          
    295          /*#if HAL_UART_USB
    296            HalUARTTx(buf, len);
    297            return len;
    298          #else
    299            return 0;
    300          #endif
    301          */
    302            return 0;
   \                     ??HalUARTWrite_0:
   \   000011   7A00         MOV     R2,#0x0
   \   000013   7B00         MOV     R3,#0x0
   \                     ??HalUARTWrite_1:
   \   000015   80..         SJMP    ?Subroutine0
    303          }
    304          
    305          /******************************************************************************
    306           * @fn      HalUARTSuspend
    307           *
    308           * @brief   Suspend UART hardware before entering PM mode 1, 2 or 3.
    309           *
    310           * @param   None
    311           *
    312           * @return  None
    313           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    314          void HalUARTSuspend( void )
   \                     HalUARTSuspend:
    315          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    316            
    317            /*
    318          #if HAL_UART_DMA
    319            HalUARTSuspendDMA();
    320          #endif
    321          #if HAL_UART_ISR
    322            HalUARTSuspendISR();
    323          #endif
    324          */
    325          }
   \   000000   02....       LJMP    ?BRET
    326          
    327          /******************************************************************************
    328           * @fn      HalUARTResume
    329           *
    330           * @brief   Resume UART hardware after exiting PM mode 1, 2 or 3.
    331           *
    332           * @param   None
    333           *
    334           * @return  None
    335           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    336          void HalUARTResume( void )
   \                     HalUARTResume:
    337          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    338            
    339            /*
    340          #if HAL_UART_DMA
    341            HalUARTResumeDMA();
    342          #endif
    343          #if HAL_UART_ISR
    344            HalUARTResumeISR();
    345          #endif
    346            */
    347          }
   \   000000   02....       LJMP    ?BRET
    348          
    349          /***************************************************************************************************
    350           * @fn      HalUARTPoll
    351           *
    352           * @brief   Poll the UART.
    353           *
    354           * @param   none
    355           *
    356           * @return  none
    357           *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    358          void HalUARTPoll(void)
   \                     HalUARTPoll:
    359          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    360            /*
    361          #if HAL_UART_DMA
    362            HalUARTPollDMA();
    363          #endif
    364          #if HAL_UART_ISR
    365            HalUARTPollISR();
    366          #endif
    367          #if HAL_UART_USB
    368            HalUARTPollUSB();
    369          #endif
    370            */
    371          }
   \   000000   02....       LJMP    ?BRET
    372          
    373          /**************************************************************************************************
    374           * @fn      Hal_UART_RxBufLen()
    375           *
    376           * @brief   Calculate Rx Buffer length - the number of bytes in the buffer.
    377           *
    378           * @param   port - UART port
    379           *
    380           * @return  length of current Rx Buffer
    381           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    382          uint16 Hal_UART_RxBufLen( uint8 port )
   \                     Hal_UART_RxBufLen:
    383          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    384            (void)port;
    385          
    386            
    387          #if (HAL_UART_DMA == 1)
    388            if (port == HAL_UART_PORT_0)  return HalUARTRxAvailDMA();
    389          #endif
    390          #if (HAL_UART_DMA == 2)
    391            if (port == HAL_UART_PORT_1)  return HalUARTRxAvailDMA();
    392          #endif
    393          #if (HAL_UART_ISR == 1)
    394            if (port == HAL_UART_PORT_0)  return HalUARTRxAvailISR();
    395          #endif
    396          #if (HAL_UART_ISR == 2)
    397            if (port == HAL_UART_PORT_1)  return HalUARTRxAvailISR();
   \   000004   7401         MOV     A,#0x1
   \   000006   69           XRL     A,R1
   \   000007   7029         JNZ     ??Hal_UART_RxBufLen_0
   \   000009   90....       MOV     DPTR,#isrCfg + 129
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   FA           MOV     R2,A
   \   00000E   90....       MOV     DPTR,#isrCfg + 128
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F8           MOV     R0,A
   \   000013   EA           MOV     A,R2
   \   000014   C3           CLR     C
   \   000015   98           SUBB    A,R0
   \   000016   E0           MOVX    A,@DPTR
   \   000017   FC           MOV     R4,A
   \   000018   4008         JC      ??Hal_UART_RxBufLen_1
   \   00001A   EA           MOV     A,R2
   \   00001B   C3           CLR     C
   \   00001C   9C           SUBB    A,R4
   \   00001D   FA           MOV     R2,A
   \   00001E   95E0         SUBB    A,0xE0 /* A   */
   \   000020   800D         SJMP    ??Hal_UART_RxBufLen_2
   \                     ??Hal_UART_RxBufLen_1:
   \   000022   7480         MOV     A,#-0x80
   \   000024   C3           CLR     C
   \   000025   9C           SUBB    A,R4
   \   000026   FC           MOV     R4,A
   \   000027   95E0         SUBB    A,0xE0 /* A   */
   \   000029   FD           MOV     R5,A
   \   00002A   EC           MOV     A,R4
   \   00002B   2A           ADD     A,R2
   \   00002C   FA           MOV     R2,A
   \   00002D   E4           CLR     A
   \   00002E   3D           ADDC    A,R5
   \                     ??Hal_UART_RxBufLen_2:
   \   00002F   FB           MOV     R3,A
   \   000030   8004         SJMP    ??Hal_UART_RxBufLen_3
    398          #endif
    399          #if HAL_UART_USB
    400            return HalUARTRxAvailUSB();
    401          #else
    402            return 0;
   \                     ??Hal_UART_RxBufLen_0:
   \   000032   7A00         MOV     R2,#0x0
   \   000034   7B00         MOV     R3,#0x0
   \                     ??Hal_UART_RxBufLen_3:
   \   000036                REQUIRE ?Subroutine1
   \   000036                ; // Fall through to label ?Subroutine1
    403          #endif
    404            
    405            
    406            //return 0;
    407          }
    408          ////////////////////////////////////////////////////////////////////////////////////// 
    409          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    410          void halProcessUartInterrupt (void)
   \                     halProcessUartInterrupt:
    411          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    412            //osal_set_event(Hal_TaskID, HAL_UART_EVENT);
    413            //if(MIN_FRAME_SIZE <= HalUARTReadISR(RX_BUFFER, 128))
    414            /*HalUARTReadISR(RX_BUFFER, 128);
    415            HalLcdWriteString("--------- SET EVENT -------------",0); 
    416            osal_set_event(GenericApp_TaskID, RX_PROCCESS_EVENT);*/
    417          
    418           // if(HalUARTReadISR(RX_BUFFER, 128))    ////////////////////////////////////////////////////////////////// ovdje treba uporediti sa minimalnom velicinom bafera, definisati MIN_FRAME_SIZE
    419           // {
    420              //HalLcdWriteString("--------- SET EVENT -------------",0); 
    421              /*
    422              HalLcdWriteString("--------- SET LAZO -------------",0); 
    423            HalLcdWriteString((char *)RX_BUFFER, 0);
    424            HalLcdWriteString("--------- SET LAZO -------------",0);
    425            */
    426              osal_set_event(GenericApp_TaskID, RX_PROCCESS_EVENT);
   \   000004                ; Setup parameters for call to function osal_set_event
   \   000004   7A00         MOV     R2,#0x0
   \   000006   7B01         MOV     R3,#0x1
   \   000008   90....       MOV     DPTR,#GenericApp_TaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   `??osal_set_event::?relay`; Banked call to: osal_set_event
    427           // }
    428          }
   \   000010   80..         SJMP    ?Subroutine1

   \                                 In  segment INTVEC, offset 0x1b, root
   \                     `??halUart1RxIsr::??INTVEC 27`:
   \   00001B   02....       LJMP       (halUart1RxIsr)

   \                                 In  segment INTVEC, offset 0x73, root
   \                     `??halUart1TxIsr::??INTVEC 115`:
   \   000073   02....       LJMP       (halUart1TxIsr)

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTReadISR::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTReadISR

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTWriteISR::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTWriteISR

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTInit::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTOpen::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTOpen

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTRead::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTRead

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTWrite::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTWrite

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTSuspend::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTSuspend

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTResume::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTResume

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??HalUARTPoll::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalUARTPoll

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??Hal_UART_RxBufLen::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Hal_UART_RxBufLen

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??halProcessUartInterrupt::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halProcessUartInterrupt
    429          ////////////////////////////////////////////////////////////////////////////////////// 
    430          /******************************************************************************
    431          ******************************************************************************/

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      2      0   HalUARTInit
      2      0   HalUARTOpen
      0      0   HalUARTPoll
      0      9   HalUARTRead
        0      9   -> HalUARTReadISR
      1     18   HalUARTReadISR
      0      0   HalUARTResume
      0      0   HalUARTSuspend
      0      9   HalUARTWrite
        0      9   -> HalUARTWriteISR
      1     18   HalUARTWriteISR
      2      0   Hal_UART_RxBufLen
      2     14   halProcessUartInterrupt
        2      0   -> osal_set_event
      1     14   halUart1RxIsr
        0     14   -> halProcessUartInterrupt
      6      0   halUart1TxIsr


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       5  ?Subroutine0
       7  ?Subroutine1
      11  ?Subroutine2
       1  ADCCFG
       1  CLKCONCMD
      98  HalUARTInit
       6  HalUARTInit::?relay
     126  HalUARTOpen
       6  HalUARTOpen::?relay
       3  HalUARTPoll
       6  HalUARTPoll::?relay
      21  HalUARTRead
       6  HalUARTRead::?relay
      81  HalUARTReadISR
       6  HalUARTReadISR::?relay
       3  HalUARTResume
       6  HalUARTResume::?relay
       3  HalUARTSuspend
       6  HalUARTSuspend::?relay
      23  HalUARTWrite
       6  HalUARTWrite::?relay
     142  HalUARTWriteISR
       6  HalUARTWriteISR::?relay
      54  Hal_UART_RxBufLen
       6  Hal_UART_RxBufLen::?relay
       1  IEN2
       1  P1SEL
       1  P2DIR
       1  P2INP
       1  PERCFG
     128  RX_BUFFER
       1  ST0
     128  TX_BUFFER
       1  U1BAUD
       1  U1DBUF
       1  U1GCR
       1  U1UCR
       1  _A_IEN0
       1  _A_IRCON2
       1  _A_U1CSR
      18  halProcessUartInterrupt
       6  halProcessUartInterrupt::?relay
      80  halUart1RxIsr
       3  halUart1RxIsr::??INTVEC 27
      82  halUart1TxIsr
       3  halUart1TxIsr::??INTVEC 115
     265  isrCfg

 
 595 bytes in segment BANKED_CODE
  66 bytes in segment BANK_RELAYS
   6 bytes in segment INTVEC
 162 bytes in segment NEAR_CODE
  15 bytes in segment SFR_AN
 521 bytes in segment XDATA_Z
 
 228 bytes of CODE     memory (+  6 bytes shared)
   0 bytes of DATA     memory (+ 15 bytes shared)
 595 bytes of HUGECODE memory
 521 bytes of XDATA    memory

Errors: none
Warnings: none
